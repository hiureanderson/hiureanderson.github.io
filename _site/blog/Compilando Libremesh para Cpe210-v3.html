<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <title>Hiure Queiroz  | Compilando Libremesh para Cpe210-v3 </title>

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="/assets/application-a8b19a6d5833e4aa0aa64c38ec45d5c9.css">
  </head>

  <body>
        <div class="navbar navbar-inverse navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Hiure Queiroz</a>
        </div>
          <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav nav-links">
              
                  <li >
                    <a href="
                                /blog
                             "
                    >Blog</a>
                  </li>
              
                  <li >
                    <a href="
                                /about
                             "
                    >About</a>
                  </li>
              
                  <li >
                    <a href="
                                /contact
                             "
                    >Contact</a>
                  </li>
              
                  <li >
                    <a href="https://github.com/hiureanderson
                               "
                    target="_blank">Github</a>
                  </li>
              
                  <li >
                    <a href="
                                /kb
                             "
                    >Knowledge Base</a>
                  </li>
              
            </ul>
          </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container">
      <h2>Compilando Libremesh para Cpe210-v3</h2>
<p class="meta">January 23, 2019</p>

<div class="post">
<p>o Cpe210-v3 não tem suporte dos desenvolvedores oficiais do OpenWrt/Lede. E no Libremesh todas as maneiras de compilar documentadas são para modelos suportados para o OpenWrt/Lede. Esse documento tem o objetivo de documentar a jornada de descobrir como compilar um firmware para um modelo não suportado pelo OpenWrt/Lede.</p>

<p>Como meu conhecimento é muito pouco ou quase nenhum esse rascunho vai começar nos passos mais elementares nessa jornada, assim é preciso entender tudo desde o mais básico na arte de compilar openwrt, alguns links: </p>

<ol>
<li><p>https://openwrt.org/docs/guide-developer/start</p></li>
<li><p>https://openwrt.org/docs/guide-developer/quickstart-build-images</p></li>
<li><p>https://openwrt.org/docs/guide-user/additional-software/beginners-build-guide</p></li>
<li><p>https://openwrt.org/docs/guide-developer/build-system/install-buildsystem</p></li>
<li><p>https://openwrt.org/docs/guide-user/additional-software/imagebuilder</p></li>
<li><p>https://openwrt.org/docs/guide-developer/build-system/use-buildsystem</p></li>
<li><p>https://openwrt.org/docs/guide-developer/build-system/use-patches-with-buildsystem</p></li>
<li><p>https://wiki.openwrt.org/doc/howto/build</p></li>
<li><p>https://github.com/openwrt/openwrt   </p></li>
</ol>

<p>Lendo tudo isso, tem algumas coisas importantes a se concluir para prosseguir:</p>

<ol>
<li><p>Não é possível fazer isso pelo ImageBuilder pois ele só vai funcionar para imagens pré-compiladas</p></li>
<li><p>Todas as dependências devem estar [[https://openwrt.org/docs/guide-developer/build-system/install-buildsystem#table<em>of</em>known_prerequisites|rigorosamente satisfeitas]]. </p></li>
</ol>

<p>Depois de tudo isso comecei fazendo um clone do repositório do openwrt já com as alterações para o cpe210-v3</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">git</span> <span class="nb">clone</span> <span class="o">-</span><span class="n">b</span> <span class="no">CPE210</span><span class="o">-</span><span class="n">v3</span><span class="o">-</span><span class="no">PR</span> <span class="o">--</span><span class="n">single</span><span class="o">-</span><span class="n">branch</span> <span class="ss">https</span><span class="p">:</span><span class="sr">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">robimarko</span><span class="o">/</span><span class="n">openwrt</span><span class="o">.</span><span class="n">git</span></code></pre></div>

<p>Feito isso acresentei os seguintes repositórios para o feed.conf</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">cp</span> <span class="n">feeds</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">default</span> <span class="n">feeds</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">local</span>
<span class="n">cp</span> <span class="n">feeds</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">default</span> <span class="n">feeds</span><span class="o">.</span><span class="n">conf</span>
<span class="n">echo</span> <span class="s2">&quot;src-git libremesh https://github.com/libremesh/lime-packages.git&quot;</span> <span class="o">&gt;&gt;</span> <span class="n">feeds</span><span class="o">.</span><span class="n">conf</span>
<span class="n">echo</span> <span class="s2">&quot;src-git libremap https://github.com/libremap/libremap-agent-openwrt.git&quot;</span> <span class="o">&gt;&gt;</span> <span class="n">feeds</span><span class="o">.</span><span class="n">conf</span>
<span class="n">echo</span> <span class="s2">&quot;src-git limeui https://github.com/libremesh/lime-packages-ui.git&quot;</span> <span class="o">&gt;&gt;</span> <span class="n">feeds</span><span class="o">.</span><span class="n">conf</span></code></pre></div>

<p>Para atualizar os pacotes fiz:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">scripts</span><span class="o">/</span><span class="n">feeds</span> <span class="n">update</span> <span class="o">-</span><span class="n">a</span>
<span class="n">scripts</span><span class="o">/</span><span class="n">feeds</span> <span class="n">install</span> <span class="o">-</span><span class="n">a</span></code></pre></div>

<p>E então para adicionar manualmente os pacotes executei:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">make</span> <span class="n">menuconfig</span></code></pre></div>

<p>Aqui foi possivel encontrar em target o cpe210-v3. Segui a sugestão do git do libremesh () que sugere destacar o pacote dnsmasq em Base system e selecionar dnsmasq-dhcpv6 na mesma seção. Selecionei também o pacote lime-full na seção [[LiMe]] &gt; collections.</p>

<p><img src="/_assets/images/menuconfig.jpg" alt="My helpful screenshot"></p>

<p>Depois de salvar, é importante dar o comando </p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">make</span> <span class="n">download</span></code></pre></div>

<p>Isso vai fazer com que você baixe todos as fontes antes de compilar, isso é importante caso você use mútlipos cores para compilar. Se não fizer isso provávelmente sua compilação falhe.</p>

<p>E então rodei:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">make</span> <span class="o">-</span><span class="n">j1</span> <span class="n">V</span><span class="o">=</span><span class="n">s</span></code></pre></div>

<p>E compulou-se uma imagem para testar.</p>

<p>Dicas:
Caso você encontre erro na compilação uma sacada é usar a seguinte linha decomando para encontrar o erro:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">make</span> <span class="n">V</span><span class="o">=</span><span class="n">s</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">build</span><span class="o">.</span><span class="n">log</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;[^_-&quot;a-z]error[^_-.a-z]&#39;</span></code></pre></div>

<p>The Knowledge Base</p>

<p>You&#39;ll find this article in your <code>kb/_posts</code> directory - edit this article and re-build (or run with the <code>-w</code> switch) to see your changes!
To add new articles, simply add a file in the <code>_posts</code> directory that follows the convention: YYYY-MM-DD-name-of-post.ext.</p>

<p>Jekyll also offers powerful support for code snippets:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">print_hi</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="s2">&quot;Hi, </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">end</span>
<span class="n">print_hi</span><span class="p">(</span><span class="s1">&#39;AJ&#39;</span><span class="p">)</span>
<span class="c1">#=&gt; prints &#39;Hi, AJ&#39; to STDOUT.</span></code></pre></div>

</div>

    </div>

    <footer>
  <div class="page-header"></div><!-- inserts the line separator -->
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          
        </div>
        <div class="col-md-4 text-center">
          <h5></h5>
        </div>
        <div class="col-md-4 text-center">
          <!-- <p><a href="http://github.com/AJAlabs/JekyllKB">Powered by JekyllKB</a></p> -->
        </div>
      </div>
    </div>
  </div>
</footer>
  <!-- JavaScript and Analytics -->
  <script src="/assets/jekyllkb-7cf223578b50d175843655211c90acc2.js"></script>
  <!-- Google Analytics: http://www.google.com/analytics/
     Replace 'UA-XXXXXXXX-X' with your property ID
======================================================= -->
<script>
  (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
  function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
  e=o.createElement(i);r=o.getElementsByTagName(i)[0];
  e.src='//www.google-analytics.com/analytics.js';
  r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
  ga('create','UA-XXXXXXXX-X');ga('send','pageview');
</script>

<!-- Place your gaug.es analytics below this line:
     http://get.gaug.es/documentation/
======================================================= -->

  
  </body>
</html>